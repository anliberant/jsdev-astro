---
title: "How to Fix flat and flatMap Not Existing on Arrays"
slug: flatmap-doesnt-exist
heading: Resolving Missing flat, flatMap, and Flatten on any[] in TypeScript
icon: /icons/typescript.png
image: /icon.png
permalink: howto/flatmap-doesnt-exist
date: 2025-01-07
author: anton liberant
category: typescript
type: howto
tags: ['flat', 'flatMap']
desc: Fix missing flat and flatMap errors in TypeScript by updating configs, ensuring modern runtime support, applying polyfills, or refactoring array logic.
---

Errors such as **“Property 'flat' does not exist on type any[]”** or **“flatMap is not a function”** appear when your TypeScript configuration or JavaScript runtime does not support the ECMAScript features that introduced these methods. The issue is not with your array type—it's with the environment in which the code is being checked or executed.

This article examines why these errors occur, how TypeScript interprets array types, and how to ensure your tooling and runtime support the modern array API. The goal is to help you eliminate the error cleanly, without resorting to unreliable workarounds, while keeping your project compatible with intended browsers or Node environments.

---

## 1. Why flat and flatMap Might Be Missing

Both methods were added in **ES2019**, which means they only appear if:

1. Your TypeScript `lib` includes ES2019 or newer.
2. Your JavaScript runtime supports ES2019.
3. Your project does not override or narrow built‑in array types.

When one of these conditions is not met, TypeScript cannot determine that the method exists—even if it would work at runtime.

---

## 2. Updating tsconfig to Include Correct Libraries

TypeScript does not assume an environment. If your `tsconfig.json` uses older ECMAScript libraries, the compiler omits modern array method definitions.

Update your configuration:

```json
{
  "compilerOptions": {
    "target": "ES2019",
    "lib": ["ES2019", "DOM"]
  }
}
```

The `"lib"` field tells the compiler which built‑in APIs exist. Without `ES2019`, the array type returned to you does not include `flat()` or `flatMap()`.

If you work in Node without DOM APIs, you can omit `"DOM"`.

---

## 3. Ensuring Your Runtime Actually Supports These Methods

Even with correct types, the runtime itself may not support ES2019 features.

### Browser environments
Older browsers (notably Internet Explorer and several older Android WebViews) do not support `.flat()`.

### Node.js environments
Node must be version **12+** to include these methods.

Check your version:

```bash
node -v
```

If you use version managers like `nvm`, ensure the correct version is active.

---

## 4. Adding Polyfills for Legacy Environments

If you need compatibility with environments that lack ES2019 support, the safest approach is to provide polyfills.

Install:

```bash
npm install core-js
```

Import the relevant features:

```js
import "core-js/features/array/flat";
import "core-js/features/array/flat-map";
```

Bundlers such as Webpack, Rollup, Parcel, and Vite will incorporate these polyfills automatically based on usage.

Polyfills expand runtime capability—they do not fix TypeScript type mismatches. Type declarations must still include ES2019 to avoid compile‑time errors.

---

## 5. Avoiding Mistakes in Type Declarations

Occasionally the problem comes from project‑specific type definitions that override global array declarations. This may happen when:

- declaration files redefine `Array<T>`,
- third‑party types conflict with built‑ins,
- `any[]` is narrowed in a custom `.d.ts`.

Explicit annotation often resolves ambiguity:

```ts
const values: (number | number[])[] = [1, 2, [3, 4]];
const result = values.flat();
```

Or when using `flatMap`:

```ts
const output = [1, 2, 3].flatMap(x => [x, x * 2]);
```

---

## 6. Using Compatible Alternatives When Necessary

If updating your environment is not possible, you can rewrite logic using standard array methods such as `reduce` and `concat`.

### Replacing flat()

```js
const nested = [1, 2, [3, 4]];
const flattened = nested.reduce((acc, val) => acc.concat(val), []);
```

### Replacing flatMap()

```js
const result = [1, 2, 3].reduce((acc, val) => {
  const mapped = [val, val * 2];
  return acc.concat(mapped);
}, []);
```

These approaches work reliably in every ES5+ environment, though they lack optional depth handling.

---

## 7. Using the Depth Argument in Polyfilled or Modern Environments

`flat()` allows flattening to arbitrary levels:

```ts
const deeplyNested = [1, [2, [3, [4]]]];
const flattened = deeplyNested.flat(3);
```

If you are targeting multiple environments, always document the maximum depth you expect. Deeper flattening can introduce performance overhead in large datasets.

---

## 8. Summary of Recommended Fixes

| Problem | Solution |
|--------|----------|
| TypeScript complaining about missing methods | Update `"lib"` to include ES2019 |
| Runtime throws “is not a function” | Upgrade Node/browser or apply polyfills |
| Custom type declarations override array methods | Review `.d.ts` files and annotate types |
| Legacy targets or outdated platforms | Use reduce/concat patterns |

---

## Conclusion

Errors involving missing `flat`, `flatMap`, or `flatten` stem from mismatched expectations between TypeScript configuration, runtime capabilities, and project type declarations. The cleanest solution is aligning your `tsconfig.json` and runtime with ES2019 or newer. When older environments must be supported, polyfills or refactoring techniques keep the codebase functional and predictable.

By understanding how TypeScript assigns array types and how your runtime interprets them, you can maintain compatibility while still using modern, expressive JavaScript APIs.